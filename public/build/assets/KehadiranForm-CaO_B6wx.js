import{c as o,y as r,j as t,k as c,z as m,A as Y,e as E,g as D,p as i,T as L,P as X,l as g,m as p,x as U,F as C,q as B,Q as R,C as Z,H as _,r as u,J as ee,E as te}from"./app-By3IWkgJ.js";const ae={class:"flex"},se={class:"flex"},re={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},le={class:"absolute -left-[9999px]","aria-hidden":"true",tabindex:"-1"},ne={key:0},ie=["value"],oe={key:1},ue=["value"],de={key:2},me=["value"],ce={class:"flex gap-4"},ge={class:"flex items-center gap-2 cursor-pointer"},ve={class:"flex items-center gap-2 cursor-pointer"},be={key:3},ke=["disabled"],fe={key:0,class:"inline-flex items-center gap-2"},xe={key:1},pe={__name:"KehadiranForm",props:{category:{type:String,required:!0},meetingId:{type:Number,required:!0},verifyUrl:{type:String,required:!0},formToken:{type:String,default:""},dark:{type:Boolean,default:!1}},emits:["verified"],setup(s,{emit:V}){const h=s,j=V,k=u(""),w=u(""),K=u(""),A=u(""),M=u(""),b=u(""),v=u("hadir"),f=u(""),T=u(""),z=["MPKK BERTAM INDAH","MPKK BUMBUNG LIMA","MPKK PERMATANG TINGGI B","MPKK PAYA KELADI","MPKK BERTAM PERDANA","MPKK PERMATANG LANGSAT","MPKK PINANG TUNGGAL","MPKK KG BAHARU","MPKK KG SELAMAT UTARA","MPKK KG SELAMAT RANGKAIAN","MPKK KG SELAMAT SELATAN","MPKK KUBANG MENERONG","MPKK KG TOK BEDU","MPKK KG DATUK","MPKK PERMATANG SINTOK","MPKK PERMATANG RAMBAI","MPKK JALAN KEDAH","MPKK PADANG BENGGALI","MPKK KUALA MUDA"],N=u(!1),n=u({}),I=u(""),x=u(""),P=u(!1),G=u(""),S=ee(()=>({matc:["Ketua Cabang","Timbalan Ketua Cabang","Naib Ketua Cabang","Setiausaha","Setiausaha Pengelola","Bendahari","Ketua Penerangan / Komunikasi","AJK"],amk:["Ketua AMK","Timbalan Ketua AMK","Naib Ketua AMK","Setiausaha","Bendahari","Ketua Penerangan","AJK"],wanita:["Ketua Wanita","Timbalan Ketua Wanita","Naib Ketua Wanita","Setiausaha","Bendahari","Ketua Penerangan","AJK"],mpkk:["Pengerusi","Setiausaha","Bendahari","AJK"]}[h.category]||[]).map(e=>({value:e,label:e})));function J(l){if(l.length!==12)return!1;const e=parseInt(l.substring(2,4),10),a=parseInt(l.substring(4,6),10),d=parseInt(l.substring(6,8),10);return e<1||e>12||a<1||a>31?!1:d>=1&&d<=16||d>=21&&d<=59||d>=60&&d<=76||d>=82&&d<=93||d===98||d===99}function F(){const l={};k.value.trim()||(l.name="Nama wajib diisi.");const e=w.value.replace(/\D/g,"");return e?e.length!==12?l.ic_number="No. IC mestilah 12 digit.":J(e)||(l.ic_number="Format No. IC tidak sah."):l.ic_number="No. IC wajib diisi.",h.category==="mpkk"&&!M.value&&(l.mpkk_name="Sila pilih MPKK."),b.value||(l.position_type="Sila pilih jenis jawatan."),v.value==="tidak_hadir"&&!f.value.trim()&&(l.absence_reason="Sila nyatakan sebab tidak hadir."),n.value=l,Object.keys(l).length===0}async function H(){if(F()){N.value=!0,I.value="",x.value="";try{const l={name:k.value.trim(),ic_number:w.value.replace(/\D/g,""),phone_number:K.value.trim()||null,address:A.value.trim()||null,position_type:b.value,mpkk_name:h.category==="mpkk"?M.value:null,status:v.value,absence_reason:v.value==="tidak_hadir"&&f.value.trim()||null,website:T.value,_ft:h.formToken},e=await te.post(h.verifyUrl,l);O(),j("verified",e.data.message)}catch(l){if(l.response?.status===422){const e=l.response.data.errors||{};if(Object.keys(e).length){n.value={};for(const[a,d]of Object.entries(e))n.value[a]=Array.isArray(d)?d[0]:d}else l.response.data?.message&&(x.value=l.response.data.message)}else l.response?.status===409?(G.value=l.response.data.message||"IC ini sudah membuat pengesahan untuk mesyuarat ini.",P.value=!0):l.response?.data?.message?x.value=l.response.data.message:x.value="Ralat berlaku. Sila cuba lagi."}finally{N.value=!1}}}function O(){k.value="",w.value="",K.value="",A.value="",M.value="",b.value="",v.value="hadir",f.value="",n.value={}}function y(l){if(n.value[l]){const{[l]:e,...a}=n.value;n.value=a}}function $(l){k.value=(l.target.value||"").toUpperCase(),y("name")}function W(l){K.value=(l.target.value||"").replace(/\D/g,"")}function q(l){A.value=(l.target.value||"").toUpperCase()}function Q(l){f.value=(l.target.value||"").toUpperCase(),y("absence_reason")}return(l,e)=>(i(),o("div",null,[I.value?(i(),o("div",{key:0,class:r(["mb-4 rounded-md p-4",s.dark?"bg-green-500/20 ring-1 ring-green-400/30":"bg-green-50"])},[t("div",ae,[e[17]||(e[17]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z","clip-rule":"evenodd"})])],-1)),t("p",{class:r(["ml-3 text-sm font-medium",s.dark?"text-green-300":"text-green-800"])},c(I.value),3)])],2)):m("",!0),x.value?(i(),o("div",{key:1,class:r(["mb-4 rounded-md p-4",s.dark?"bg-red-500/20 ring-1 ring-red-400/30":"bg-red-50"])},[t("div",se,[e[18]||(e[18]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z","clip-rule":"evenodd"})])],-1)),t("p",{class:r(["ml-3 text-sm font-medium",s.dark?"text-red-300":"text-red-800"])},c(x.value),3)])],2)):m("",!0),(i(),Y(X,{to:"body"},[E(L,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:D(()=>[P.value?(i(),o("div",re,[t("div",{class:"fixed inset-0 bg-black/60",onClick:e[0]||(e[0]=a=>P.value=!1)}),E(L,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:D(()=>[P.value?(i(),o("div",{key:0,class:r(["relative w-full max-w-sm rounded-2xl p-6 text-center shadow-2xl",s.dark?"bg-sky-900 ring-1 ring-white/10":"bg-white"])},[t("div",{class:r(["mx-auto mb-4 flex h-14 w-14 items-center justify-center rounded-full",s.dark?"bg-red-500/20":"bg-red-100"])},[...e[19]||(e[19]=[t("svg",{class:"h-7 w-7 text-red-500",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z","clip-rule":"evenodd"})],-1)])],2),t("h3",{class:r(["mb-2 text-lg font-bold",s.dark?"text-white":"text-gray-900"])},"Rekod Telah Wujud",2),t("p",{class:r(["mb-6 text-sm",s.dark?"text-sky-100/70":"text-gray-600"])},c(G.value),3),t("button",{onClick:e[1]||(e[1]=a=>P.value=!1),class:r(["w-full rounded-xl px-4 py-2.5 text-sm font-semibold text-white shadow-sm transition",s.dark?"bg-sky-500 hover:bg-sky-400":"bg-red-600 hover:bg-red-500"])}," Tutup ",2)],2)):m("",!0)]),_:1})])):m("",!0)]),_:1})])),t("form",{onSubmit:_(H,["prevent"]),class:"space-y-4 sm:space-y-5"},[t("div",le,[e[20]||(e[20]=t("label",{for:"website"},"Website",-1)),g(t("input",{id:"website","onUpdate:modelValue":e[2]||(e[2]=a=>T.value=a),type:"text",name:"website",tabindex:"-1",autocomplete:"off"},null,512),[[p,T.value]])]),s.category==="mpkk"?(i(),o("div",ne,[t("label",{for:"mpkk_name",class:r(["block text-xs font-medium sm:text-sm",s.dark?"text-sky-100/80":"text-gray-700"])},"Pilih MPKK",2),g(t("select",{id:"mpkk_name","onUpdate:modelValue":e[3]||(e[3]=a=>M.value=a),onChange:e[4]||(e[4]=a=>y("mpkk_name")),class:r(["mt-1 block w-full rounded-lg shadow-sm",[s.dark?"border-0 bg-white/10 text-white ring-1 focus:ring-2 "+(n.value.mpkk_name?"ring-red-400/50 focus:ring-red-400":"ring-white/15 focus:ring-sky-400"):n.value.mpkk_name?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"]])},[t("option",{value:"",class:r(s.dark?"bg-sky-900 text-white":"")},"-- Pilih MPKK --",2),(i(),o(C,null,B(z,a=>t("option",{key:a,value:a,class:r(s.dark?"bg-sky-900 text-white":"")},c(a),11,ie)),64))],34),[[U,M.value]]),n.value.mpkk_name?(i(),o("p",{key:0,class:r(["mt-1 text-xs sm:text-sm",s.dark?"text-red-300":"text-red-600"])},c(n.value.mpkk_name),3)):m("",!0)])):m("",!0),s.category==="mpkk"?(i(),o("div",oe,[t("label",{for:"position_type_mpkk",class:r(["block text-xs font-medium sm:text-sm",s.dark?"text-sky-100/80":"text-gray-700"])},"Jawatan Dalam MPKK",2),g(t("select",{id:"position_type_mpkk","onUpdate:modelValue":e[5]||(e[5]=a=>b.value=a),onChange:e[6]||(e[6]=a=>y("position_type")),class:r(["mt-1 block w-full rounded-lg shadow-sm",[s.dark?"border-0 bg-white/10 text-white ring-1 focus:ring-2 "+(n.value.position_type?"ring-red-400/50 focus:ring-red-400":"ring-white/15 focus:ring-sky-400"):n.value.position_type?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"]])},[t("option",{value:"",class:r(s.dark?"bg-sky-900 text-white":"")},"-- Pilih jawatan --",2),(i(!0),o(C,null,B(S.value,a=>(i(),o("option",{key:a.value,value:a.value,class:r(s.dark?"bg-sky-900 text-white":"")},c(a.label),11,ue))),128))],34),[[U,b.value]]),n.value.position_type?(i(),o("p",{key:0,class:r(["mt-1 text-xs sm:text-sm",s.dark?"text-red-300":"text-red-600"])},c(n.value.position_type),3)):m("",!0)])):m("",!0),t("div",null,[t("label",{for:"name",class:r(["block text-xs font-medium sm:text-sm",s.dark?"text-sky-100/80":"text-gray-700"])},"Nama Penuh",2),g(t("input",{id:"name","onUpdate:modelValue":e[7]||(e[7]=a=>k.value=a),type:"text",autocomplete:"name",onInput:$,class:r(["mt-1 block w-full rounded-lg shadow-sm text-base sm:text-lg uppercase",[s.dark?"border-0 bg-white/10 text-white placeholder-sky-300/40 ring-1 focus:ring-2 "+(n.value.name?"ring-red-400/50 focus:ring-red-400":"ring-white/15 focus:ring-sky-400"):n.value.name?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"]])},null,34),[[p,k.value]]),n.value.name?(i(),o("p",{key:0,class:r(["mt-1 text-xs sm:text-sm",s.dark?"text-red-300":"text-red-600"])},c(n.value.name),3)):m("",!0)]),t("div",null,[t("label",{for:"ic_number",class:r(["block text-xs font-medium sm:text-sm",s.dark?"text-sky-100/80":"text-gray-700"])},"No. Kad Pengenalan",2),g(t("input",{id:"ic_number","onUpdate:modelValue":e[8]||(e[8]=a=>w.value=a),type:"text",inputmode:"numeric",placeholder:"880101145678",autocomplete:"off",onInput:e[9]||(e[9]=a=>y("ic_number")),class:r(["mt-1 block w-full rounded-lg shadow-sm text-base sm:text-lg",[s.dark?"border-0 bg-white/10 text-white placeholder-sky-300/40 ring-1 focus:ring-2 "+(n.value.ic_number?"ring-red-400/50 focus:ring-red-400":"ring-white/15 focus:ring-sky-400"):n.value.ic_number?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"]])},null,34),[[p,w.value]]),n.value.ic_number?(i(),o("p",{key:0,class:r(["mt-1 text-xs sm:text-sm",s.dark?"text-red-300":"text-red-600"])},c(n.value.ic_number),3)):m("",!0)]),t("div",null,[t("label",{for:"phone_number",class:r(["block text-xs font-medium sm:text-sm",s.dark?"text-sky-100/80":"text-gray-700"])},"No. Telefon",2),g(t("input",{id:"phone_number","onUpdate:modelValue":e[10]||(e[10]=a=>K.value=a),type:"tel",inputmode:"numeric",placeholder:"0121234567",autocomplete:"tel",onInput:W,class:r(["mt-1 block w-full rounded-lg shadow-sm",s.dark?"border-0 bg-white/10 text-white placeholder-sky-300/40 ring-1 ring-white/15 focus:ring-2 focus:ring-sky-400":"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"])},null,34),[[p,K.value]])]),t("div",null,[t("label",{for:"address",class:r(["block text-xs font-medium sm:text-sm",s.dark?"text-sky-100/80":"text-gray-700"])},"Alamat",2),g(t("textarea",{id:"address","onUpdate:modelValue":e[11]||(e[11]=a=>A.value=a),rows:"2",onInput:q,class:r(["mt-1 block w-full rounded-lg shadow-sm uppercase",s.dark?"border-0 bg-white/10 text-white placeholder-sky-300/40 ring-1 ring-white/15 focus:ring-2 focus:ring-sky-400":"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"])},null,34),[[p,A.value]])]),s.category!=="mpkk"?(i(),o("div",de,[t("label",{for:"position_type",class:r(["block text-xs font-medium sm:text-sm",s.dark?"text-sky-100/80":"text-gray-700"])},"Jenis Jawatan",2),g(t("select",{id:"position_type","onUpdate:modelValue":e[12]||(e[12]=a=>b.value=a),onChange:e[13]||(e[13]=a=>y("position_type")),class:r(["mt-1 block w-full rounded-lg shadow-sm",[s.dark?"border-0 bg-white/10 text-white ring-1 focus:ring-2 "+(n.value.position_type?"ring-red-400/50 focus:ring-red-400":"ring-white/15 focus:ring-sky-400"):n.value.position_type?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"]])},[t("option",{value:"",class:r(s.dark?"bg-sky-900 text-white":"")},"-- Pilih jawatan --",2),(i(!0),o(C,null,B(S.value,a=>(i(),o("option",{key:a.value,value:a.value,class:r(s.dark?"bg-sky-900 text-white":"")},c(a.label),11,me))),128))],34),[[U,b.value]]),n.value.position_type?(i(),o("p",{key:0,class:r(["mt-1 text-xs sm:text-sm",s.dark?"text-red-300":"text-red-600"])},c(n.value.position_type),3)):m("",!0)])):m("",!0),t("div",null,[t("label",{class:r(["block text-xs font-medium sm:text-sm mb-2",s.dark?"text-sky-100/80":"text-gray-700"])},"Status Kehadiran",2),t("div",ce,[t("label",ge,[g(t("input",{type:"radio","onUpdate:modelValue":e[14]||(e[14]=a=>v.value=a),value:"hadir",class:"h-4 w-4 text-emerald-500 focus:ring-emerald-400"},null,512),[[R,v.value]]),t("span",{class:r(["text-sm font-medium",s.dark?"text-white":"text-gray-800"])},"Hadir",2)]),t("label",ve,[g(t("input",{type:"radio","onUpdate:modelValue":e[15]||(e[15]=a=>v.value=a),value:"tidak_hadir",class:"h-4 w-4 text-red-500 focus:ring-red-400"},null,512),[[R,v.value]]),t("span",{class:r(["text-sm font-medium",s.dark?"text-white":"text-gray-800"])},"Tidak Hadir",2)])])]),v.value==="tidak_hadir"?(i(),o("div",be,[t("label",{for:"absence_reason",class:r(["block text-xs font-medium sm:text-sm",s.dark?"text-sky-100/80":"text-gray-700"])},"Nyatakan Sebab Tidak Hadir",2),g(t("textarea",{id:"absence_reason","onUpdate:modelValue":e[16]||(e[16]=a=>f.value=a),rows:"3",onInput:Q,class:r(["mt-1 block w-full rounded-lg shadow-sm uppercase",[s.dark?"border-0 bg-white/10 text-white placeholder-sky-300/40 ring-1 focus:ring-2 "+(n.value.absence_reason?"ring-red-400/50 focus:ring-red-400":"ring-white/15 focus:ring-sky-400"):n.value.absence_reason?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"]])},null,34),[[p,f.value]]),n.value.absence_reason?(i(),o("p",{key:0,class:r(["mt-1 text-xs sm:text-sm",s.dark?"text-red-300":"text-red-600"])},c(n.value.absence_reason),3)):m("",!0)])):m("",!0),t("button",{type:"submit",disabled:N.value,class:r(s.dark?"w-full rounded-xl bg-sky-500 px-4 py-3 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 transition hover:bg-sky-400 disabled:opacity-50 disabled:cursor-not-allowed":"w-full rounded-md bg-green-600 px-4 py-3 text-sm font-semibold text-white shadow-sm hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed")},[N.value?(i(),o("span",fe,[...e[21]||(e[21]=[t("svg",{class:"h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),Z(" Menghantar... ",-1)])])):(i(),o("span",xe,"Hantar"))],10,ke)],32)]))}};export{pe as _};
