import{r as k,w as S,c as r,e as f,u as o,f as H,g as y,j as t,p as a,k as n,z as d,l as C,m as O,x as U,F as m,q as K,A as g,C as b,B as j,y as z,b as D,D as $}from"./app-BdwxNAMg.js";import{_ as I}from"./AuthenticatedLayout-CbbxVCB-.js";import{u as W}from"./useDragScroll-S6tKOsQ9.js";const q={class:"flex items-center justify-between"},G={class:"py-12"},J={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},Q={key:0,class:"mb-4 rounded-md bg-emerald-400/15 p-4 ring-1 ring-emerald-400/20"},X={class:"text-sm text-emerald-300"},Y={key:1,class:"mb-4 rounded-md bg-red-400/15 p-4 ring-1 ring-red-400/20"},Z={class:"text-sm text-red-300"},ee={class:"mb-4 flex flex-wrap items-end gap-4"},te={class:"w-full sm:w-auto"},se={class:"w-full sm:w-auto"},ae={key:0,class:"w-full sm:w-auto"},oe=["value"],re=["disabled"],ie={key:0,class:"h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},le={class:"overflow-hidden rounded-2xl bg-white/10 shadow-lg backdrop-blur-md ring-1 ring-white/15"},ne={class:"min-w-full divide-y divide-white/10"},de={class:"bg-white/5"},ue={key:0,class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},pe={class:"divide-y divide-white/10"},ce={class:"whitespace-nowrap px-6 py-4 uppercase"},me={class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},xe={class:"whitespace-nowrap px-6 py-4"},he={class:"inline-flex items-center rounded-full bg-sky-400/15 px-2.5 py-0.5 text-xs font-medium text-sky-300 ring-1 ring-sky-400/20 uppercase"},we={class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},ye={key:0,class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},ke={class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},fe={class:"px-6 py-4 text-sm text-sky-200/50 uppercase min-w-[12rem]"},ge={class:"whitespace-nowrap px-6 py-4 text-right text-sm"},be=["onClick"],ve={key:0},_e=["colspan"],Me={key:2,class:"mt-4 flex justify-center"},Ce=["innerHTML"],Te={__name:"Index",props:{members:Object,filters:Object,mpkkList:Array},setup(p){const v=p,c=$(),x=k(v.filters.search||""),l=k(v.filters.category||""),u=k(v.filters.mpkk||""),{scrollEl:V,onMouseDown:L,onMouseLeave:P,onMouseUp:T,onMouseMove:A}=W();function _(){const i={};x.value&&(i.search=x.value),l.value&&(i.category=l.value),l.value==="mpkk"&&u.value&&(i.mpkk=u.value),D.get(route("members.index"),i,{preserveState:!0,replace:!0})}S(x,()=>_());function B(){u.value="",_()}function N(){_()}S(l,i=>{i!=="mpkk"&&(u.value="")});function E(i){confirm("Adakah anda pasti mahu memadam ahli ini?")&&D.delete(route("members.destroy",i))}const F={matc:"Cabang",amk:"AMK",wanita:"Wanita Cabang",mpkk:"MPKK"},h=k(!1);async function R(){const i=new URLSearchParams({category:l.value});u.value&&i.set("mpkk",u.value),h.value=!0;try{const e=await fetch("/export/members-pdf?"+i.toString(),{credentials:"same-origin",headers:{Accept:"application/pdf"}});if(!e.ok)throw new Error("Server returned "+e.status);const s=await e.blob(),M=URL.createObjectURL(s),w=document.createElement("a");w.href=M,w.download=e.headers.get("Content-Disposition")?.match(/filename="?(.+?)"?$/)?.[1]||"ahli.pdf",document.body.appendChild(w),w.click(),w.remove(),URL.revokeObjectURL(M)}catch(e){alert("Gagal muat turun PDF: "+e.message)}finally{h.value=!1}}return(i,e)=>(a(),r(m,null,[f(o(H),{title:"Ahli"}),f(I,null,{header:y(()=>[t("div",q,[e[8]||(e[8]=t("h2",{class:"text-xl font-semibold leading-tight text-white"},"Senarai Ahli",-1)),o(c).props.auth.user.is_admin?(a(),j(o(b),{key:0,href:i.route("members.create"),class:"inline-flex items-center rounded-md bg-sky-500 px-3 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 hover:bg-sky-400"},{default:y(()=>[...e[7]||(e[7]=[g(" Tambah Ahli ",-1)])]),_:1},8,["href"])):d("",!0)])]),default:y(()=>[t("div",G,[t("div",J,[o(c).props.flash.success?(a(),r("div",Q,[t("p",X,n(o(c).props.flash.success),1)])):d("",!0),o(c).props.flash.error?(a(),r("div",Y,[t("p",Z,n(o(c).props.flash.error),1)])):d("",!0),t("div",ee,[t("div",te,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-sky-100/80 mb-1"},"Cari",-1)),C(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>x.value=s),type:"text",placeholder:"Cari ahli...",class:"w-full rounded-md border-0 bg-white/10 text-white ring-1 ring-white/15 placeholder-sky-200/40 focus:ring-2 focus:ring-sky-400 sm:w-64"},null,512),[[O,x.value]])]),t("div",se,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-sky-100/80 mb-1"},"Kategori",-1)),C(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value=s),onChange:B,class:"w-full rounded-md border-0 bg-white/10 text-white ring-1 ring-white/15 focus:ring-2 focus:ring-sky-400 sm:w-48"},[...e[10]||(e[10]=[t("option",{value:"",class:"bg-sky-900 text-white"},"Semua",-1),t("option",{value:"matc",class:"bg-sky-900 text-white"},"Cabang",-1),t("option",{value:"wanita",class:"bg-sky-900 text-white"},"Wanita Cabang",-1),t("option",{value:"amk",class:"bg-sky-900 text-white"},"AMK",-1),t("option",{value:"mpkk",class:"bg-sky-900 text-white"},"MPKK",-1)])],544),[[U,l.value]])]),l.value==="mpkk"?(a(),r("div",ae,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-sky-100/80 mb-1"},"MPKK",-1)),C(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>u.value=s),onChange:N,class:"w-full rounded-md border-0 bg-white/10 text-white ring-1 ring-white/15 focus:ring-2 focus:ring-sky-400 sm:w-64"},[e[12]||(e[12]=t("option",{value:"",class:"bg-sky-900 text-white"},"Semua MPKK",-1)),(a(!0),r(m,null,K(p.mpkkList,s=>(a(),r("option",{key:s,value:s,class:"bg-sky-900 text-white"},n(s),9,oe))),128))],544),[[U,u.value]])])):d("",!0),l.value?(a(),r("button",{key:1,type:"button",onClick:R,disabled:h.value,class:"inline-flex items-center gap-2 rounded-md bg-emerald-600 px-3 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-600/30 hover:bg-emerald-500 disabled:opacity-50"},[h.value?(a(),r("svg",ie,[...e[14]||(e[14]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):d("",!0),g(" "+n(h.value?"Memuat turun...":"Muat Turun PDF"),1)],8,re)):d("",!0)]),t("div",le,[t("div",{ref_key:"scrollEl",ref:V,class:"overflow-x-auto cursor-grab",onMousedown:e[3]||(e[3]=(...s)=>o(L)&&o(L)(...s)),onMouseleave:e[4]||(e[4]=(...s)=>o(P)&&o(P)(...s)),onMouseup:e[5]||(e[5]=(...s)=>o(T)&&o(T)(...s)),onMousemove:e[6]||(e[6]=(...s)=>o(A)&&o(A)(...s))},[t("table",ne,[t("thead",de,[t("tr",null,[e[15]||(e[15]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Nama",-1)),e[16]||(e[16]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"No. IC",-1)),e[17]||(e[17]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Kategori",-1)),e[18]||(e[18]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Jawatan",-1)),l.value==="mpkk"?(a(),r("th",ue,"MPKK")):d("",!0),e[19]||(e[19]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Telefon",-1)),e[20]||(e[20]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Alamat",-1)),e[21]||(e[21]=t("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Tindakan",-1))])]),t("tbody",pe,[(a(!0),r(m,null,K(p.members.data,s=>(a(),r("tr",{key:s.id,class:"hover:bg-white/5"},[t("td",ce,[f(o(b),{href:i.route("members.show",s.id),class:"text-sky-300 hover:text-sky-200"},{default:y(()=>[g(n(s.name),1)]),_:2},1032,["href"])]),t("td",me,n(s.ic_number),1),t("td",xe,[t("span",he,n(s.category_type==="mpkk"?s.position_name||"MPKK":F[s.category_type]||s.category_type),1)]),t("td",we,n(s.position_type||"-"),1),l.value==="mpkk"?(a(),r("td",ye,n(s.position_name||"-"),1)):d("",!0),t("td",ke,n(s.phone_number),1),t("td",fe,n(s.address||"-"),1),t("td",ge,[o(c).props.auth.user.is_admin?(a(),r(m,{key:0},[f(o(b),{href:i.route("members.edit",s.id),class:"text-sky-300 hover:text-sky-200 mr-3"},{default:y(()=>[...e[22]||(e[22]=[g("Ubah",-1)])]),_:1},8,["href"]),t("button",{onClick:M=>E(s.id),class:"text-red-300 hover:text-red-200"},"Padam",8,be)],64)):d("",!0)])]))),128)),p.members.data.length?d("",!0):(a(),r("tr",ve,[t("td",{colspan:l.value==="mpkk"?8:7,class:"px-6 py-4 text-center text-sm text-sky-200/50"},"Tiada ahli dijumpai.",8,_e)]))])])],544)]),p.members.links.length>3?(a(),r("div",Me,[(a(!0),r(m,null,K(p.members.links,s=>(a(),r(m,{key:s.label},[s.url?(a(),j(o(b),{key:0,href:s.url,innerHTML:s.label,class:z(["mx-1 rounded border px-3 py-1 text-sm",s.active?"bg-sky-500 text-white border-sky-500":"bg-white/10 text-sky-100 border-white/15 hover:bg-white/20"])},null,8,["href","innerHTML","class"])):(a(),r("span",{key:1,innerHTML:s.label,class:"mx-1 rounded border border-white/10 bg-white/5 px-3 py-1 text-sm text-sky-300/40"},null,8,Ce))],64))),128))])):d("",!0)])])]),_:1})],64))}};export{Te as default};
