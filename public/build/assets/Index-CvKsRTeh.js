import{r as w,w as F,c as i,e as b,u as o,f as q,g as f,j as s,p as a,k as r,z as d,l as C,m as G,x as R,F as h,q as K,B as v,C as P,A as V,y as J,b as B,D as Q,E as X}from"./app-By3IWkgJ.js";import{_ as Y}from"./AuthenticatedLayout-WvZZlO_O.js";import{u as Z}from"./useDragScroll-DxmIaAdi.js";const ee={class:"flex items-center justify-between"},te={class:"py-12"},se={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},ae={key:0,class:"mb-4 rounded-md bg-emerald-400/15 p-4 ring-1 ring-emerald-400/20"},oe={class:"text-sm text-emerald-300"},ie={key:1,class:"mb-4 rounded-md bg-red-400/15 p-4 ring-1 ring-red-400/20"},ne={class:"text-sm text-red-300"},le={key:2,class:"mb-4 rounded-md bg-red-400/15 p-4 ring-1 ring-red-400/20"},re={class:"text-sm text-red-300"},de={class:"mb-4 flex flex-wrap items-end gap-4"},ue={class:"w-full sm:w-auto"},pe={class:"w-full sm:w-auto"},ce={key:0,class:"w-full sm:w-auto"},me=["value"],xe=["disabled"],he={class:"overflow-hidden rounded-2xl bg-white/10 shadow-lg backdrop-blur-md ring-1 ring-white/15"},ke={class:"min-w-full divide-y divide-white/10"},ye={class:"bg-white/5"},we={key:0,class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},fe={class:"divide-y divide-white/10"},ge={class:"whitespace-nowrap px-6 py-4 uppercase"},be={class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},ve={class:"whitespace-nowrap px-6 py-4"},_e={class:"inline-flex items-center rounded-full bg-sky-400/15 px-2.5 py-0.5 text-xs font-medium text-sky-300 ring-1 ring-sky-400/20 uppercase"},Me={class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},Ce={key:0,class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},Ke={class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},Pe={class:"px-6 py-4 text-sm text-sky-200/50 uppercase min-w-[12rem]"},Le={class:"whitespace-nowrap px-6 py-4 text-right text-sm"},Se=["onClick"],Te={key:0},Ue=["colspan"],Ae={key:3,class:"mt-4 flex justify-center"},De=["innerHTML"],Ve={__name:"Index",props:{members:Object,filters:Object,mpkkList:Array},setup(m){const _=m,x=Q(),k=w(_.filters.search||""),l=w(_.filters.category||""),u=w(_.filters.mpkk||""),{scrollEl:E,onMouseDown:L,onMouseLeave:S,onMouseUp:T,onMouseMove:U}=Z();function M(){const n={};k.value&&(n.search=k.value),l.value&&(n.category=l.value),l.value==="mpkk"&&u.value&&(n.mpkk=u.value),B.get(route("members.index"),n,{preserveState:!0,replace:!0})}F(k,()=>M());function N(){u.value="",M()}function H(){M()}F(l,n=>{n!=="mpkk"&&(u.value="")});function O(n){confirm("Adakah anda pasti mahu memadam ahli ini?")&&B.delete(route("members.destroy",n))}const z={matc:"Cabang",amk:"AMK",wanita:"Wanita Cabang",mpkk:"MPKK"},g=w(!1),p=w("");async function I(){g.value=!0,p.value="";const n=new URLSearchParams({category:l.value});u.value&&n.set("mpkk",u.value);const e="/export/members-pdf?"+n.toString();try{const t=await X.get(e,{responseType:"blob"});if(!(t.headers["content-type"]||"").includes("application/pdf")){p.value="Respons bukan PDF. Sila muat semula halaman dan cuba lagi.";return}const W=t.headers["content-disposition"]||"";let A="ahli.pdf";const D=W.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);D&&(A=D[1].replace(/['"]/g,""));const $=new Blob([t.data],{type:"application/pdf"}),j=window.URL.createObjectURL($),y=document.createElement("a");y.href=j,y.download=A,document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(j)}catch(t){const c=t.response?.status;c===401||c===419?p.value="Sesi anda telah tamat. Sila muat semula halaman dan log masuk semula.":c===403?p.value="Anda tidak dibenarkan memuat turun PDF ini.":c===422?p.value="Parameter tidak sah. Sila pilih kategori.":p.value="Gagal muat turun PDF (Ralat "+(c||"rangkaian")+"). Sila cuba lagi."}finally{g.value=!1}}return(n,e)=>(a(),i(h,null,[b(o(q),{title:"Ahli"}),b(Y,null,{header:f(()=>[s("div",ee,[e[8]||(e[8]=s("h2",{class:"text-xl font-semibold leading-tight text-white"},"Senarai Ahli",-1)),o(x).props.auth.user.is_admin?(a(),V(o(v),{key:0,href:n.route("members.create"),class:"inline-flex items-center rounded-md bg-sky-500 px-3 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 hover:bg-sky-400"},{default:f(()=>[...e[7]||(e[7]=[P(" Tambah Ahli ",-1)])]),_:1},8,["href"])):d("",!0)])]),default:f(()=>[s("div",te,[s("div",se,[o(x).props.flash.success?(a(),i("div",ae,[s("p",oe,r(o(x).props.flash.success),1)])):d("",!0),o(x).props.flash.error?(a(),i("div",ie,[s("p",ne,r(o(x).props.flash.error),1)])):d("",!0),p.value?(a(),i("div",le,[s("p",re,r(p.value),1)])):d("",!0),s("div",de,[s("div",ue,[e[9]||(e[9]=s("label",{class:"block text-sm font-medium text-sky-100/80 mb-1"},"Cari",-1)),C(s("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>k.value=t),type:"text",placeholder:"Cari ahli...",class:"w-full rounded-md border-0 bg-white/10 text-white ring-1 ring-white/15 placeholder-sky-200/40 focus:ring-2 focus:ring-sky-400 sm:w-64"},null,512),[[G,k.value]])]),s("div",pe,[e[11]||(e[11]=s("label",{class:"block text-sm font-medium text-sky-100/80 mb-1"},"Kategori",-1)),C(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),onChange:N,class:"w-full rounded-md border-0 bg-white/10 text-white ring-1 ring-white/15 focus:ring-2 focus:ring-sky-400 sm:w-48"},[...e[10]||(e[10]=[s("option",{value:"",class:"bg-sky-900 text-white"},"Semua",-1),s("option",{value:"matc",class:"bg-sky-900 text-white"},"Cabang",-1),s("option",{value:"wanita",class:"bg-sky-900 text-white"},"Wanita Cabang",-1),s("option",{value:"amk",class:"bg-sky-900 text-white"},"AMK",-1),s("option",{value:"mpkk",class:"bg-sky-900 text-white"},"MPKK",-1)])],544),[[R,l.value]])]),l.value==="mpkk"?(a(),i("div",ce,[e[13]||(e[13]=s("label",{class:"block text-sm font-medium text-sky-100/80 mb-1"},"MPKK",-1)),C(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>u.value=t),onChange:H,class:"w-full rounded-md border-0 bg-white/10 text-white ring-1 ring-white/15 focus:ring-2 focus:ring-sky-400 sm:w-64"},[e[12]||(e[12]=s("option",{value:"",class:"bg-sky-900 text-white"},"Semua MPKK",-1)),(a(!0),i(h,null,K(m.mpkkList,t=>(a(),i("option",{key:t,value:t,class:"bg-sky-900 text-white"},r(t),9,me))),128))],544),[[R,u.value]])])):d("",!0),l.value?(a(),i("button",{key:1,onClick:I,disabled:g.value,class:"inline-flex items-center rounded-md bg-emerald-600 px-3 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-600/30 hover:bg-emerald-500 disabled:opacity-50 disabled:cursor-wait"},r(g.value?"Memuat turun...":"Muat Turun PDF"),9,xe)):d("",!0)]),s("div",he,[s("div",{ref_key:"scrollEl",ref:E,class:"overflow-x-auto cursor-grab",onMousedown:e[3]||(e[3]=(...t)=>o(L)&&o(L)(...t)),onMouseleave:e[4]||(e[4]=(...t)=>o(S)&&o(S)(...t)),onMouseup:e[5]||(e[5]=(...t)=>o(T)&&o(T)(...t)),onMousemove:e[6]||(e[6]=(...t)=>o(U)&&o(U)(...t))},[s("table",ke,[s("thead",ye,[s("tr",null,[e[14]||(e[14]=s("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Nama",-1)),e[15]||(e[15]=s("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"No. IC",-1)),e[16]||(e[16]=s("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Kategori",-1)),e[17]||(e[17]=s("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Jawatan",-1)),l.value==="mpkk"?(a(),i("th",we,"MPKK")):d("",!0),e[18]||(e[18]=s("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Telefon",-1)),e[19]||(e[19]=s("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Alamat",-1)),e[20]||(e[20]=s("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Tindakan",-1))])]),s("tbody",fe,[(a(!0),i(h,null,K(m.members.data,t=>(a(),i("tr",{key:t.id,class:"hover:bg-white/5"},[s("td",ge,[b(o(v),{href:n.route("members.show",t.id),class:"text-sky-300 hover:text-sky-200"},{default:f(()=>[P(r(t.name),1)]),_:2},1032,["href"])]),s("td",be,r(t.ic_number),1),s("td",ve,[s("span",_e,r(t.category_type==="mpkk"?t.position_name||"MPKK":z[t.category_type]||t.category_type),1)]),s("td",Me,r(t.position_type||"-"),1),l.value==="mpkk"?(a(),i("td",Ce,r(t.position_name||"-"),1)):d("",!0),s("td",Ke,r(t.phone_number),1),s("td",Pe,r(t.address||"-"),1),s("td",Le,[o(x).props.auth.user.is_admin?(a(),i(h,{key:0},[b(o(v),{href:n.route("members.edit",t.id),class:"text-sky-300 hover:text-sky-200 mr-3"},{default:f(()=>[...e[21]||(e[21]=[P("Ubah",-1)])]),_:1},8,["href"]),s("button",{onClick:c=>O(t.id),class:"text-red-300 hover:text-red-200"},"Padam",8,Se)],64)):d("",!0)])]))),128)),m.members.data.length?d("",!0):(a(),i("tr",Te,[s("td",{colspan:l.value==="mpkk"?8:7,class:"px-6 py-4 text-center text-sm text-sky-200/50"},"Tiada ahli dijumpai.",8,Ue)]))])])],544)]),m.members.links.length>3?(a(),i("div",Ae,[(a(!0),i(h,null,K(m.members.links,t=>(a(),i(h,{key:t.label},[t.url?(a(),V(o(v),{key:0,href:t.url,innerHTML:t.label,class:J(["mx-1 rounded border px-3 py-1 text-sm",t.active?"bg-sky-500 text-white border-sky-500":"bg-white/10 text-sky-100 border-white/15 hover:bg-white/20"])},null,8,["href","innerHTML","class"])):(a(),i("span",{key:1,innerHTML:t.label,class:"mx-1 rounded border border-white/10 bg-white/5 px-3 py-1 text-sm text-sky-300/40"},null,8,De))],64))),128))])):d("",!0)])])]),_:1})],64))}};export{Ve as default};
