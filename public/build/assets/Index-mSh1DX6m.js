import{r as w,w as F,c as i,e as S,u as o,f as O,g as f,j as t,p as a,k as r,z as n,l as b,F as k,q as v,x as M,A as D,B as T,C as z,y as H,D as I,b as W}from"./app-BdwxNAMg.js";import{_ as $}from"./AuthenticatedLayout-CbbxVCB-.js";import{u as q}from"./useDragScroll-S6tKOsQ9.js";const G={class:"py-12"},J={class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},Q={key:0,class:"mb-4 rounded-md bg-emerald-400/15 p-4 ring-1 ring-emerald-400/20"},X={class:"text-sm text-emerald-300"},Y={key:1,class:"mb-4 rounded-md bg-red-400/15 p-4 ring-1 ring-red-400/20"},Z={class:"text-sm text-red-300"},ee={class:"mb-4 flex flex-wrap items-end gap-4"},te={class:"w-full sm:w-auto"},se=["value"],ae={key:0,class:"w-full sm:w-auto"},ie={key:1,class:"w-full sm:w-auto"},oe=["value"],re={key:2,class:"overflow-hidden rounded-2xl bg-white/10 shadow-lg backdrop-blur-md ring-1 ring-white/15"},le={class:"p-4 sm:p-6"},ne={class:"flex flex-wrap items-center justify-between gap-3 mb-4"},de={class:"text-lg font-medium text-white"},ue={class:"flex items-center gap-2"},pe=["disabled"],me={key:0,class:"h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ce={key:0,class:"min-w-full divide-y divide-white/10"},xe={class:"bg-white/5"},ge={key:0,class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},we={class:"divide-y divide-white/10"},ke={class:"whitespace-nowrap px-6 py-4 text-sm text-white uppercase"},ye={class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},he={class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/80 uppercase"},fe={class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},be={key:0,class:"whitespace-nowrap px-6 py-4 text-sm text-sky-200/50 uppercase"},ve={class:"px-6 py-4 text-sm text-sky-200/80 uppercase min-w-[12rem]"},Me={class:"whitespace-nowrap px-6 py-4"},_e={class:"px-6 py-4 text-sm text-sky-200/50 uppercase min-w-[10rem]"},Ce={key:0,class:"text-sm text-sky-200/50 mt-4"},Ke={key:3,class:"overflow-hidden rounded-2xl bg-white/10 shadow-lg backdrop-blur-md ring-1 ring-white/15"},De={__name:"Index",props:{meetings:Object,meeting:Object,attendances:Array,filters:Object,mpkkList:Array},setup(u){const y=u,m=I(),c=w(y.filters.meeting_id||""),l=w(y.filters.category||""),p=w(y.filters.mpkk||""),{scrollEl:U,onMouseDown:_,onMouseLeave:C,onMouseUp:K,onMouseMove:L}=q();function h(){const d={meeting_id:c.value};l.value&&(d.category=l.value),l.value==="mpkk"&&p.value&&(d.mpkk=p.value),W.get(route("attendances.index"),d,{preserveState:!0,replace:!0})}function A(){l.value="",p.value="",h()}function V(){p.value="",h()}function j(){h()}F(l,d=>{d!=="mpkk"&&(p.value="")});const R={matc:"Cabang",amk:"AMK",wanita:"Wanita Cabang",mpkk:"MPKK"},B={present:"Hadir",absent:"Tidak Hadir",late:"Lewat",excused:"Dimaafkan"},N={present:"bg-emerald-400/15 text-emerald-300 ring-1 ring-emerald-400/20",absent:"bg-red-400/15 text-red-300 ring-1 ring-red-400/20",late:"bg-yellow-400/15 text-yellow-300 ring-1 ring-yellow-400/20",excused:"bg-white/10 text-sky-200 ring-1 ring-white/15"},x=w(!1);async function E(){const d=new URLSearchParams({meeting_id:c.value,category:l.value});p.value&&d.set("mpkk",p.value),x.value=!0;try{const e=await fetch("/export/attendance-pdf?"+d.toString(),{credentials:"same-origin",headers:{Accept:"application/pdf"}});if(!e.ok)throw new Error("Server returned "+e.status);const s=await e.blob(),P=URL.createObjectURL(s),g=document.createElement("a");g.href=P,g.download=e.headers.get("Content-Disposition")?.match(/filename="?(.+?)"?$/)?.[1]||"kehadiran.pdf",document.body.appendChild(g),g.click(),g.remove(),URL.revokeObjectURL(P)}catch(e){alert("Gagal muat turun PDF: "+e.message)}finally{x.value=!1}}return(d,e)=>(a(),i(k,null,[S(o(O),{title:"Kehadiran"}),S($,null,{header:f(()=>[...e[7]||(e[7]=[t("h2",{class:"text-xl font-semibold leading-tight text-white"},"Rekod Kehadiran",-1)])]),default:f(()=>[t("div",G,[t("div",J,[o(m).props.flash.success?(a(),i("div",Q,[t("p",X,r(o(m).props.flash.success),1)])):n("",!0),o(m).props.flash.error?(a(),i("div",Y,[t("p",Z,r(o(m).props.flash.error),1)])):n("",!0),t("div",ee,[t("div",te,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-sky-100/80 mb-1"},"Pilih Mesyuarat",-1)),b(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),onChange:A,class:"w-full rounded-md border-0 bg-white/10 text-white ring-1 ring-white/15 focus:ring-2 focus:ring-sky-400 sm:min-w-[20rem]"},[e[8]||(e[8]=t("option",{value:"",class:"bg-sky-900 text-white"},"-- Pilih Mesyuarat --",-1)),(a(!0),i(k,null,v(u.meetings.data,s=>(a(),i("option",{key:s.id,value:s.id,class:"bg-sky-900 text-white"},r(s.title)+" ("+r(s.date)+") ",9,se))),128))],544),[[M,c.value]])]),c.value?(a(),i("div",ae,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-sky-100/80 mb-1"},"Kategori",-1)),b(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.value=s),onChange:V,class:"w-full rounded-md border-0 bg-white/10 text-white ring-1 ring-white/15 focus:ring-2 focus:ring-sky-400 sm:w-48"},[...e[10]||(e[10]=[t("option",{value:"",class:"bg-sky-900 text-white"},"Semua",-1),t("option",{value:"matc",class:"bg-sky-900 text-white"},"Cabang",-1),t("option",{value:"wanita",class:"bg-sky-900 text-white"},"Wanita Cabang",-1),t("option",{value:"amk",class:"bg-sky-900 text-white"},"AMK",-1),t("option",{value:"mpkk",class:"bg-sky-900 text-white"},"MPKK",-1)])],544),[[M,l.value]])])):n("",!0),l.value==="mpkk"?(a(),i("div",ie,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-sky-100/80 mb-1"},"MPKK",-1)),b(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>p.value=s),onChange:j,class:"w-full rounded-md border-0 bg-white/10 text-white ring-1 ring-white/15 focus:ring-2 focus:ring-sky-400 sm:w-64"},[e[12]||(e[12]=t("option",{value:"",class:"bg-sky-900 text-white"},"Semua MPKK",-1)),(a(!0),i(k,null,v(u.mpkkList,s=>(a(),i("option",{key:s,value:s,class:"bg-sky-900 text-white"},r(s),9,oe))),128))],544),[[M,p.value]])])):n("",!0)]),u.meeting?(a(),i("div",re,[t("div",le,[t("div",ne,[t("h3",de,r(u.meeting.title),1),t("div",ue,[l.value?(a(),i("button",{key:0,type:"button",onClick:E,disabled:x.value,class:"inline-flex items-center gap-2 rounded-md bg-emerald-600 px-3 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-600/30 hover:bg-emerald-500 disabled:opacity-50"},[x.value?(a(),i("svg",me,[...e[14]||(e[14]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"},null,-1)])])):n("",!0),D(" "+r(x.value?"Memuat turun...":"Muat Turun PDF"),1)],8,pe)):n("",!0),o(m).props.auth.user.is_admin?(a(),T(o(z),{key:1,href:d.route("attendances.mark",u.meeting.id),class:"inline-flex items-center rounded-md bg-sky-500 px-3 py-2 text-sm font-semibold text-white shadow-lg shadow-sky-500/30 hover:bg-sky-400"},{default:f(()=>[...e[15]||(e[15]=[D(" Rekod Kehadiran ",-1)])]),_:1},8,["href"])):n("",!0)])]),t("div",{ref_key:"scrollEl",ref:U,class:"overflow-x-auto cursor-grab",onMousedown:e[3]||(e[3]=(...s)=>o(_)&&o(_)(...s)),onMouseleave:e[4]||(e[4]=(...s)=>o(C)&&o(C)(...s)),onMouseup:e[5]||(e[5]=(...s)=>o(K)&&o(K)(...s)),onMousemove:e[6]||(e[6]=(...s)=>o(L)&&o(L)(...s))},[u.attendances.length?(a(),i("table",ce,[t("thead",xe,[t("tr",null,[e[16]||(e[16]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Nama Ahli",-1)),e[17]||(e[17]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"No. IC",-1)),e[18]||(e[18]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Kategori",-1)),e[19]||(e[19]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Jawatan",-1)),l.value==="mpkk"?(a(),i("th",ge,"MPKK")):n("",!0),e[20]||(e[20]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Alamat",-1)),e[21]||(e[21]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Status",-1)),e[22]||(e[22]=t("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-sky-200/60 whitespace-nowrap"},"Sebab",-1))])]),t("tbody",we,[(a(!0),i(k,null,v(u.attendances,s=>(a(),i("tr",{key:s.id,class:"hover:bg-white/5"},[t("td",ke,r(s.member?.name),1),t("td",ye,r(s.member?.ic_number),1),t("td",he,r(s.member?.category_type==="mpkk"?s.member?.position_name||"MPKK":R[s.member?.category_type]||"-"),1),t("td",fe,r(s.member?.position_type||"-"),1),l.value==="mpkk"?(a(),i("td",be,r(s.member?.position_name||"-"),1)):n("",!0),t("td",ve,r(s.member?.address||"-"),1),t("td",Me,[t("span",{class:H(["inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",N[s.status]||"bg-white/10 text-sky-200 ring-1 ring-white/15"])},r(B[s.status]||s.status),3)]),t("td",_e,r(s.status==="absent"&&s.absence_reason||"-"),1)]))),128))])])):n("",!0)],544),u.attendances.length?n("",!0):(a(),i("p",Ce,"Tiada rekod kehadiran untuk mesyuarat ini."))])])):(a(),i("div",Ke,[...e[23]||(e[23]=[t("div",{class:"p-6 text-center text-sm text-sky-200/50"}," Sila pilih mesyuarat untuk melihat rekod kehadiran. ",-1)])]))])])]),_:1})],64))}};export{De as default};
